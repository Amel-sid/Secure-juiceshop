# ğŸ“ CrÃ©er dossier pour la conf montable dans le conteneur
- name: ğŸ“ CrÃ©er dossier /opt/nginx
  file:
    path: /opt/nginx
    state: directory
    mode: '0755'
  become: yes

- name: ğŸ“ CrÃ©er dossier pour les logs nginx partagÃ©s
  file:
    path: /var/log/nginx
    state: directory
    owner: root
    group: adm
    mode: '0755'
  become: yes


# ğŸ“‚ Copier la conf Juice Shop dans /opt
- name: ğŸ“‚ Copier le fichier de conf nginx
  copy:
    src: juice-proxy.conf
    dest: /opt/nginx/juice-proxy.conf

# ğŸ³ Lancer Nginx comme conteneur Docker, reliÃ© Ã  juice_net
- name: Lancer Nginx avec Juice Shop
  docker_container:
    name: juice-proxy
    image: nginx
    state: started
    restart_policy: always
    published_ports:
      - "80:80"  #  Port exposÃ© vers la VM
    volumes:
      - /opt/nginx/juice-proxy.conf:/etc/nginx/conf.d/default.conf:ro
    networks:
      - name: juice_net


